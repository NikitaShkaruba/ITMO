###Caution!
This code has buggy writeW macros! 
Forgive me and this damned code :unamused: